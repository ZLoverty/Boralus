# 挖槽工具开发总结

## 需求定义

将 AI 根据照片生成的人类头部多色 3D 模型拆分为容易打印的可拼装的单色件，并在脖子处制作一个弹性槽以连接身体标准件。

## 工作流步骤细分

### 1. 将 3D 模型拆分为容易打印的可拼装的单色件（未完成）

我们考虑使用开源的 AI 拆分模型实现（如 [Hunyuan3D Part](https://github.com/Tencent-Hunyuan/Hunyuan3D-Part)）。

### 2. 在脖子处制作一个弹性槽

#### 2.1 弹性槽 CAD 建模

由于需要配合精度，所以相比 AI 生成适配结构，比较稳健的做法是自行 CAD 建模，再用布尔运算整合到原模型的合适位置。[这里](https://polymaker1-my.sharepoint.com/:u:/g/personal/zhengyang_liu_polymaker_com/IQB0mWv1Q8ZSQaHjR92dOAggAZYkOWvd_UhUUcIG6Fck6m4?e=XMNo3A)是我画的弹性槽 CAD 图，为公母两件，用法是从头上减去母件，再在身体上加上公件，即可装配。

#### 2.2 布尔运算自动化

我基于`trimesh`开发了一个简单的布尔运算工具，基本逻辑是找到脖子位置 -> 且为头身两份 -> 在头件和身件通过布尔运算添加装配结构。[这里](https://github.com/ZLoverty/Boralus/blob/main/slot_generator/slot.ipynb)是具体实现。

#### 2.3 多色模型的处理

由于 .stl 文件不带颜色信息，且`trimesh`中即使是有色模型，在布尔运算后由于顶点信息变化，部分顶点的颜色没有定义，所以布尔运算后模型的颜色会消失。为了在布尔运算同时保留原模型的颜色信息，需要在每次布尔运算后做一次顶点的颜色映射，基于空间位置将原模型的颜色保留下来。[这里](https://github.com/ZLoverty/Boralus/blob/main/slot_generator/multi_color_model.ipynb)是具体实现。
